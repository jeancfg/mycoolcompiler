<html><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> 



<title>Compilatoare</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="description" content="Compilatoare">
    <meta http-equiv="distribution" content="\&quot;Global\&quot;">
    <link rel="stylesheet" href="Tema2_files/base.css" type="text/css">
    <link rel="stylesheet" href="Tema2_files/vmchecker.css" type="text/css">



</head><body>

<table width="70%" align="center" border="0" cellpadding="5" cellspacing="0">
    <tbody><tr><td class="fontwhite" align="center" bgcolor="slateblue">
	 Compilatoare    </td></tr>
    <tr><td class="fontnavy" align="center" bgcolor="#cc99ff">
	Teme&nbsp;
    </td></tr>
</tbody></table>

<table width="100%" border="0" cellpadding="0" cellspacing="0"><tbody><tr><td align="center"><br>
<table width="96%" border="0" cellpadding="0" cellspacing="0">

    <tbody><tr>
	<td valign="top" width="16%">
	    
	<br>
	<table width="100%" border="0" cellpadding="5" cellspacing="4">
    	<tbody><tr><td align="center" bgcolor="#cc99ff"> 
	
        <a href="http://cs.pub.ro/%7Ecpl/index.php" class="linknavy">Home</a>
	
	</td></tr>
        <tr><td align="center" bgcolor="slateblue"> 
	<br><a href="http://cs.pub.ro/%7Ecpl/index.php?section=Laborator" class="linkwhite">Laborator </a><br><br><a href="http://cs.pub.ro/%7Ecpl/index.php?section=Curs" class="linkwhite">Curs </a><br><br><a href="http://cs.pub.ro/%7Ecpl/index.php?section=Utile" class="linkwhite">Utile </a><br><br><a href="http://cs.pub.ro/%7Ecpl/index.php?section=Teme" class="linkwhite">Teme <br>(03 Nov 23:52)</a><br><br><a href="http://cs.pub.ro/%7Ecpl/index.php?section=Login" class="linkwhite">Login </a><br>
	<br></td></tr>
	<tr><td bgcolor="white">&nbsp;<br><br></td></tr>
	</tbody></table>
		</td>
	<td width="1%">
	    &nbsp;
	</td>
	<td valign="top" width="62%" bgcolor="">
	    <table width="100%" border="0" cellpadding="10" cellspacing="0">
	    <tbody><tr><td>
    	        <p align="right"><a href="http://cs.pub.ro/%7Ecpl/wiki/index.php?title=Teme:Tema%202" target="_blank">WIKI</a> | <a href="http://cs.pub.ro/%7Ecpl/Teme/Tema%202.pdf">PDF</a></p><h1 align="center">Tema 2</h1>			<p><big><b>Tema de casă 2 - Analiza sintactică şi semantică</b></big>
</p><p><br>
</p>
<table id="toc" class="toc" summary="Contents"><tbody><tr><td><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1"><a href="#Informa.C5.A3ii_organizatorice"><span class="tocnumber">1</span> <span class="toctext">Informaţii organizatorice</span></a></li>
<li class="toclevel-1"><a href="#Enun.C5.A3"><span class="tocnumber">2</span> <span class="toctext">Enunţ</span></a>
<ul>
<li class="toclevel-2"><a href="#Analiza_lexical.C4.83"><span class="tocnumber">2.1</span> <span class="toctext">Analiza lexicală</span></a></li>
<li class="toclevel-2"><a href="#Analiza_sintactic.C4.83"><span class="tocnumber">2.2</span> <span class="toctext">Analiza sintactică</span></a></li>
<li class="toclevel-2"><a href="#Analiza_semantic.C4.83"><span class="tocnumber">2.3</span> <span class="toctext">Analiza semantică</span></a></li>
<li class="toclevel-2"><a href="#Tratarea_erorilor"><span class="tocnumber">2.4</span> <span class="toctext">Tratarea erorilor</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#Formatul_datelor"><span class="tocnumber">3</span> <span class="toctext">Formatul datelor</span></a></li>
<li class="toclevel-1"><a href="#Prezentarea_arhivei"><span class="tocnumber">4</span> <span class="toctext">Prezentarea arhivei</span></a></li>
<li class="toclevel-1"><a href="#Bonus"><span class="tocnumber">5</span> <span class="toctext">Bonus</span></a>
<ul>
<li class="toclevel-2"><a href="#Formatul_directivelor_de_preprocesare"><span class="tocnumber">5.1</span> <span class="toctext">Formatul directivelor de preprocesare</span></a></li>
<li class="toclevel-2"><a href="#Modificarea_compilatorului"><span class="tocnumber">5.2</span> <span class="toctext">Modificarea compilatorului</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#Instruc.C5.A3iuni_de_predare_a_temei"><span class="tocnumber">6</span> <span class="toctext">Instrucţiuni de predare a temei</span></a></li>
<li class="toclevel-1"><a href="#Testarea_.C5.9Fi_notarea"><span class="tocnumber">7</span> <span class="toctext">Testarea şi notarea</span></a></li>
<li class="toclevel-1"><a href="#Download"><span class="tocnumber">8</span> <span class="toctext">Download</span></a></li>
</ul>
</td></tr></tbody></table><script type="text/javascript"> if (window.showTocToggle) { var tocShowText = "show"; var tocHideText = "hide"; showTocToggle(); } </script>
<a name="Informa.C5.A3ii_organizatorice"></a><h2> <span class="mw-headline"> Informaţii organizatorice </span></h2>
<ul><li> <b>Deadline</b>: Aveţi la dispoziţie <b>3 săptămâni</b> pentru a rezolva această temă de casă. Termenul limită până când se pot trimite temele fără depunctări de întârziere este <b>duminică, 15 noiembrie 2009, ora 22:00</b>. Pentru mai multe detalii, consultaţi <a href="http://cs.pub.ro/%7Ecpl/wiki/index.php/Teme:Reguli" title="Teme:Reguli">regulamentul</a> aferent temelor de casă.
</li></ul>
<ul><li> <b>Colaborare</b>: Tema poate fi rezolvată în echipe de <b>2</b> persoane. Va trebui să înregistraţi <a href="http://spreadsheets.google.com/viewform?formkey=dG4xUW1zekJHaVVEcWNobHJQSm9kUHc6MA" class="external text" title="http://spreadsheets.google.com/viewform?formkey=dG4xUW1zekJHaVVEcWNobHJQSm9kUHc6MA" rel="nofollow">aici</a> echipa până în ziua de <b>duminică, 1 noiembrie 2009, ora 22.00</b>
. Este permis şi lucrul individual, deşi acesta este descurajat. Vă
prevenim că este o temă considerabil mai dificilă decât celelalte şi nu
ne asumăm nici o obligaţie dacă porniţi pe cont propriu şi nu reuşiţi
să finalizaţi programul. Fiecare temă va fi tratată la fel ca
celelalte, indiferent de componenţa echipei.
</li></ul>
<ul><li> <b>Punctare</b>: Se vor acorda <b>100 de puncte</b> pentru
implementarea completă şi corectă a analizei semantice şi sintactice.
De asemenea, se pot acorda bonusuri, conform secţiunii corespunzătoare
de mai jos.
</li></ul>
<a name="Enun.C5.A3"></a><h2> <span class="mw-headline"> Enunţ </span></h2>
<p>Va trebui să realizaţi, în limbajul Java şi folosind ANTLR,
porţiunea responsabilă cu analiza lexicală, sintactică şi semantică a
codului sursă, pentru un compilator COOL. Programul vostru va trebui să
primească la intrare codul sursă COOL, şi să furnizeze la ieşire
informaţii semantice (un AST adnotat cu informaţii de tip) pentru
generatorul de cod.
</p><p><b>Documentaţia principală în cadrul acestei teme va fi <a href="http://cs.pub.ro/%7Ecpl/arhive/cool-manual.pdf" class="external text" title="http://cs.pub.ro/~cpl/arhive/cool-manual.pdf" rel="nofollow">manualul limbajului COOL.</a></b>Acesta este împărţit în două părţi:
</p>
<ul><li> O specificaţie informală a limbajului (primele 9 secţiuni),
uşor de înţeles şi care vă va ajuta să schiţaţi structura principală a
limbajului.
</li><li> O specificaţie formală (matematică, riguroasă), mult mai
greu de urmărit, în secţiunile 10-13, dar care defineşte complet
limbajul şi care vă va ajuta în rezolvarea corner-case-urilor şi a
eventualelor ambiguităţi la orice nivel. Dacă nu înţelegeţi ceva de
acolo, întrebaţi pe lista de discuţii.
</li></ul>
<p><b>Programul realizat de voi va comunica cu restul compilatorului (generatorul de cod), pentru a obţine o variantă completă de <tt>coolc</tt>.</b> Această versiune de <tt>coolc</tt> va fi folosită pentru a testa tema voastră.
</p>
<a name="Analiza_lexical.C4.83"></a><h3> <span class="mw-headline"> Analiza lexicală </span></h3>
<p>În cadrul analizei lexicale, va trebui să urmăriţi următoarele puncte:
</p>
<ul><li> Să modelaţi în ANTLR, folosind expresii regulate, fragmente şi
orice alte facilităţi oferite de ANTLR, tokenii lexicali ai limbajului
COOL, şi să generaţi clasa care scanează fişierul/fişierele sursă.
</li><li> Să trataţi în mod <b>eficient</b> tokenii case-insensitive.
</li><li> Atentie la string-uri!
</li><li> Să semnalaţi erorile lexicale apărute (de partea aceasta se poate ocupa automat ANTLR).
</li><li> Tratarea adecvată a comentariilor din COOL. Conform
specificaţiilor COOL, ele pot fi imbricate. Puteţi trata comentariile
inca din lexer, folosindu-vă de exemplu de funcţiile <b>LA</b> şi <b>consume</b> ce se aplică unui obiect de tip ANTLRInputStream.
</li></ul>
<a name="Analiza_sintactic.C4.83"></a><h3> <span class="mw-headline"> Analiza sintactică </span></h3>
<ul><li> Să scrieţi în ANTLR reguli care să descrie structura
sintactică a limbajului COOL, şi să generaţi o clasă ANTLR care să
primească la intrare un stream de tokeni lexicali şi să furnizeze la
ieşire nodul rădăcină al unui Abstract Syntax Tree, care va fi parsat
mai departe în cadrul analizei semantice.
</li><li> Să evitaţi regulile ambigue (care să poată genera pentru
acelaşi input AST-uri diferite). În cazul in care aveţi reguli ambigue
încercaţi să le evitaţi prin predicate sintactice.
</li><li> Să vă definiţi o limită între analiza sintactică şi cea
semantică, şi să evitaţi orice verificare semantică la acest pas (de
exemplu nu verificaţi acum dacă variabilele folosite sunt definite în
contextul respectiv).
</li><li> Să detectaţi şi să afişaţi erorile de natură sintactică.
</li><li> Atenţie la ce prioritate acordaţi instrucţiunilor de tip if, while, let, case ...
</li></ul>
<a name="Analiza_semantic.C4.83"></a><h3> <span class="mw-headline"> Analiza semantică </span></h3>
<ul><li> Să scrieţi una, sau chiar mai multe gramatici ANTLR de tip
tree care să primească la intrare o structură de AST, s-o îmbogăţească
eventual cu informaţii (de exemplu informaţii de tip) şi în acelaşi
timp să verifice corectitudinea semantică a programului. Puteţi avea
nevoie de mai multe gramatici în cazul în care consideraţi necesară
parcurgerea arborelui de mai multe ori. În urma aplicării tuturor
trecerilor, în final va rezulta un AST prezent sub forma unei ierarhii
de obiecte ce vor fi scrise serial la ieşirea standard. Aceste date vor
constitui input-ul generatorului de cod (pe care vi-l oferim noi), care
încheie procedura de compilare.
</li><li> Să respectaţi restricţiile impuse de limbaj(a se consulata
manualul limbajului). De ex., trebuie verificat dacă nu cumva se
moşteneşte de la una din clasele de bază(Object,IO,String,Int,Bool),
dacă o clasă a fost definită de mai multe ori, dacă exista o clasă Main
şi aceasta conţine o metodă main, dacă graful format de clasele din
fişierele de la input formează un graf aciclic, etc.
</li><li> Să colectaţi definiţiile de variabile în tabele de
simboluri, şi pe baza acestora să verificaţi corectitudinea expresiilor
din cadrul metodelor şi să adnotaţi cu informaţii de tip fiecare nod
din AST.
</li></ul>
<div style="border: 1px solid rgb(85, 85, 85); padding: 0.5em 0.5em 0.5em 2em; background-color: rgb(255, 204, 170);">
<table style="background: transparent none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous; width: 100%;">
<tbody><tr>
<td><b>Atenție!</b>
</td></tr>
<tr>
<td>Această parte este <b>cea mai dificilă</b> din întreaga temă! Vă recomandăm să vă alocaţi suficient timp pentru ea (~ jumătate din timpul total alocat temei).
</td></tr></tbody></table>
</div>
<a name="Tratarea_erorilor"></a><h3> <span class="mw-headline"> Tratarea erorilor </span></h3>
<p>Deşi este necesar ca programul vostru să funcţioneze corect pentru
date de intrare valide (programe COOL corecte din punct de vedere
sintactic şi semantic), el trebuie de asemenea să reacţioneze
corespunzător şi în cazul datelor de intrare invalide. În acest sens,
indiferent de natura fişierului de intrare, programul vostru <b>nu trebuie sub nici o formă</b> să lanseze excepţii netratate; cu alte cuvinte, "să nu crape".
</p><p>Tratarea erorilor se poate face în 2 moduri:
</p>
<ul><li> Încheierea execuţiei printr-un mesaj corespunzător la prima
eroare apărută, fie aceasta lexicală, sintactică sau semantică. În
acest caz programul vostru va oferi foarte puţine informaţii
utilizatorului, însă este destul de uşor de scris.
</li><li> Afişarea a cât mai multor erori şi încercarea de recuperare
a procesului de analiză după fiecare eroare. Majoritatea
compilatoarelor moderne procedează astfel, însă în acest caz codul
vostru va fi ceva mai elaborat: la fiecare pas, sintactic sau semantic,
parserul va trebui să se aştepte şi la date eronate de la pasul
precedent, care le-a detectat, le-a afişat, dar a trecut mai departe.
</li></ul>
<p>În cadrul acestei teme, puteţi aborda <b>oricare dintre cele două strategii</b>, iar mesajul/-ele de eroare trebuie să fie afişate pe <b>stderr</b> şi să conţină:
</p>
<ul><li> <b>linia</b> şi <b>coloana</b> unde are loc eroarea, în fişierul sursă
<ul><li> pentru erorile semantice nu e nevoie sa afişaţi decât linia la care a apărut eroarea
</li><li> în cazul în care eroarea nu e provocată de o anumită linie
din fişierele sursă, de exemplu lipsa clasei Main, nu e nevoie să
specificaţi nici măcar linia la care e apărut eroare.
</li></ul>
</li><li> un <b>mesaj</b> care să descrie eroarea - mesajul să fie cât
mai sugestiv. Puteţi consulta mesajele oferite de compilatorul oficial
de cool la întâmpinarea unei erori lexicale/sintactice/semantice.
</li></ul>
<p>Reamintim că ANTLR oferă suport implicit pentru tratarea erorilor
lexicale şi sintactice, însă nu şi semantice; erorile semantice sunt
detectate de codul vostru scris explicit, şi nu de vreo regulă ANTLR.
Puteţi de asemenea să modificaţi comportamentul implicit al ANTLR
(condiţiile de afişare ale mesajelor, formatul acestora; de exemplu, pe
partea de lexer, puteţi modifica comportamentul acestuia atunci când
întâlneşte o eroare; comportarea implicită este aceea de a afişa un
warning şi de a ignora caracterul invalid; puteţi rescrie una din
funcţiile clasei Lexer <a href="http://www.antlr.org/api/Java/classorg_1_1antlr_1_1runtime_1_1_lexer.html" class="external autonumber" title="http://www.antlr.org/api/Java/classorg_1_1antlr_1_1runtime_1_1_lexer.html" rel="nofollow">[1]</a> astfel încât, spre exemplu, la întâmpinarea unei erori, să se afişeze un mesaj şi să se oprească procesul de compilare).
</p>
<div style="border: 1px solid rgb(85, 85, 85); padding: 0.5em 0.5em 0.5em 2em; background-color: rgb(204, 255, 204);">
<table style="background: transparent none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous; width: 100%;">
<tbody><tr>
<td><b>Sfat</b>
</td></tr>
<tr>
<td>Nu vă complicaţi cu varianta a doua dacă simţiţi că nu aveţi timp
să duceţi tema până la capăt. Deşi este de apreciat o implementare cât
mai completă şi în privinţa tratării erorilor, contează în primul rând
ca <b>întreg</b> sistemul să funcţioneze corect.
</td></tr></tbody></table>
</div>
<a name="Formatul_datelor"></a><h2> <span class="mw-headline"> Formatul datelor </span></h2>
<p>În urma compilării temei, va trebui să rezulte un fişier <b><tt>bin/COOLParser.class</tt></b> (package default), ce va conţine funcţia <tt>main()</tt>
asociată programului. Programul va citi de la linia de comandă numele
unuia sau mai multor fişier COOL, pe care le va procesa, şi va furniza
la ieşire un AST adnotat cu informaţiile necesare generatorului de cod.
Pentru a formata corespunzător AST-ul, vă punem la dispoziţie o serie
de clase ce descriu un AST şi o clasă de serializare, pe care să o
folosiţi la scrierea AST-ului la ieşire. Secţiunea următoare prezintă
conţinutul arhivei cu codul pe care va trebui să-l extindeţi/folosiţi.
</p><p><br>
<b>Exemplu:</b>
</p><p>Intrare (<tt>hello.cl</tt>):
</p>
<pre>(* 
	hello.cl - A simple Hello World COOL file
*)

class Main {
	main(): Int {
		0
	};
};
</pre>
<p><br>
Ieşire (<tt>stdout</tt>); nu vă interesează atât de mult formatul, pentru că aveţi în arhivă codul care generează acest text:
</p>
<pre>#1
_program
  #5
  _class
    Main
    Object
    "hello.cl"
    (
    #6
    _method
      main
      Int
      #7
      _int
        0
     &nbsp;: Int
    )
</pre>
<a name="Prezentarea_arhivei"></a><h2> <span class="mw-headline"> Prezentarea arhivei </span></h2>
<p>Pentru a rezolva această temă, va trebui să porniţi de la <b><a href="http://cs.pub.ro/%7Ecpl/static/tema2/t2cpl.tar.gz" class="external text" title="http://cs.pub.ro/~cpl/static/tema2/t2cpl.tar.gz" rel="nofollow">această arhivă</a></b>.
</p><p>Structura arhivei este următoarea:
</p>
<ul><li> <tt>/bin</tt> - directorul care va conţine toate binarele generate (fişierele <tt>.class</tt>).
</li><li> <tt>/cgen</tt> - executabilul <b>generatorului de cod</b>, care primeşte la intrare codificarea AST-ului adnotat cu informaţii de tip, furnizat de programul vostru.
</li><li> <tt>/cool-tree.aps</tt> - un fişier din care au fost generate sursele <tt>.java</tt>
corespunzătoare nodurilor AST-ului. Are valoare pur informativă (nu
este folosit în procesul de compilare), pentru că vă dă o privire de
ansamblu asupra structurii arborelui.
</li><li> <tt>/doc</tt> - documentaţia JavaDoc a tuturor claselor prezente în această arhivă. Puteţi studia varianta online şi <a href="http://cs.pub.ro/%7Ecpl/static/tema2/treeapi/" class="external text" title="http://cs.pub.ro/~cpl/static/tema2/treeapi/" rel="nofollow">aici</a>. Cele mai importante pagini sunt cele asociate claselor <tt>TreeNode</tt>, <tt>AbstractTable</tt> şi <tt>ClassTable</tt>.
</li><li> <tt>/hello.cl</tt> - un program COOL minimal în jurul căruia
puteţi să scrieţi prima parte a parserului. Într-o prima fază, puteţi
scrie suficient cod cât să puteţi compila acest program, să vedeţi
toate cum se leagă între ele, apoi extindeţi programul pentru restul
sintaxei COOL.
</li><li> <tt>/java-cup-11a-runtime.jar</tt> - o arhiva de clasă necesară la compilarea programului vostru (trebuie să fie prezentă în classpath când rulaţi <tt>javac</tt>). Nu este necesară la execuţie.
</li></ul>
<div style="border: 1px solid rgb(0, 0, 0); padding: 0.3em;">
<ul><li> <tt>/mycoolc</tt> - un script care pune cap la cap programul vostru şi generatorul de cod - reprezintă o variantă funcţional echivalentă cu <tt>coolc</tt>, dacă programul vostrul este corect.
</li></ul>
</div>
<ul><li> <tt>/src</tt> - director ce conţine toate sursele de care aveţi nevoie pentru parsing şi output.
</li></ul>
<p>Fişierele sursă prezente în arhivă sunt următoarele (<i>(r/o)</i> înseamnă că nu trebuie modificat, <i>(r/w)</i> înseamnă că poate fi modificat):
</p>
<ul><li> <tt>AbstractSymbol.java</tt> <i>(r/o)</i> - clasa ce reprezintă un simbol (identificator, întreg sau string) în API-ul de construire a arborelui.
</li><li> <tt>AbstractTable.java</tt> <i>(r/o)</i> - clasă care
încapsulează o tabelă de simboluri şi care oferă 3 tabele statice
pentru identificatori, întregi, respectiv şiruri de caractere, pe care
va trebui să le folosiţi în codul vostru.
</li><li> <tt>ASTConstants.java</tt> <i>(r/o)</i> - clasă internă (nu vă interesează)
</li><li> <tt>ASTLexer.java</tt> <i>(r/o)</i> - clasă internă
</li><li> <tt>ASTParser.java</tt> <i>(r/o)</i> - clasă internă
</li><li> <tt>BoolConst.java</tt> <i>(r/o)</i> - o clasă ce conţine câmpuri statice pentru simbolurile booleene (true şi false)
</li><li> <tt>CgenSupport.java</tt> <i>(r/o)</i> - clasă internă
</li><li> <tt>ClassTable.java</tt> <i>(r/w)</i> - o clasă care vă ajută să reprezentaţi graful claselor COOL. Puteţi s-o extindeţi cu orice funcţionalităţi aveţi nevoie.
</li><li> <tt>cool-tree.java</tt> <i>(r/w)</i> - fişier care conţine
toate clasele asociate nodurilor din AST. Puteţi să le extindeţi cu
orice alte câmpuri mai aveţi nevoie (tabele de simboluri, etc.).
</li></ul>
<div style="border: 1px solid rgb(0, 0, 0); padding: 0.3em;">
<ul><li> <tt>COOLParser.java</tt> <i>(r/w)</i> - clasa principală a
programului. Conţine un exemplu de mecanism prin care sunt puse cap la
cap toate componentele sistemului. Poate fi rescris / extins după
preferinţele fiecăruia.
</li></ul>
</div>
<ul><li> <tt>COOLTreeBuilder.g</tt> <i>(r/w)</i> - un stub de gramatică pentru analiza sintactică, pe care puteţi să-l completaţi / rescrieţi.
</li><li> <tt>COOLTreeChecker.g</tt> <i>(r/w)</i> - un stub de gramatică tree pentru analiza semantică / construirea arborelui de serializat.
</li><li> <tt>Flags.java</tt> <i>(r/o)</i> - o clasă utilitară pentru
procesarea parametrilor la linia de comandă. Procesarea are loc similar
cu cea făcută de compilatorul <tt>coolc</tt> original.
</li><li> <tt>IdSymbol.java</tt> <i>(r/o)</i> - încapsulează un simbol de tip identificator.
</li><li> <tt>IdTable.java</tt> <i>(r/o)</i> - o specializare a clasei <tt>AbstractTable</tt> care poate ţine simboluri de tip identificator.
</li><li> <tt>IntSymbol.java</tt> <i>(r/o)</i>
</li><li> <tt>IntTable.java</tt> <i>(r/o)</i> 
</li><li> <tt>ListNode.java</tt> <i>(r/o)</i> - un nod din arbore ce conţine o listă de descendenţi.
</li><li> <tt>Semant.java</tt> <i>(r/o)</i> - neutilizat
</li><li> <tt>StringSymbol.java</tt> <i>(r/o)</i>
</li><li> <tt>StringTable.java</tt> <i>(r/o)</i>
</li><li> <tt>SymtabExample.java</tt> <i>(r/o)</i> - exemplu de utilizare pentru o tabelă de simboluri
</li><li> <tt>TokenConstants.java</tt> <i>(r/o)</i> - neutilizat
</li><li> <tt>TreeConstants.java</tt> <i>(r/w)</i> - o serie de constante specifice limbajului. Puteţi îmbogăţi lista şi cu alte constante.
</li><li> <tt>TreeNode.java</tt> <i>(r/o)</i> - clasa de bază pentru nodurile din arborele sintactic
</li><li> <tt>Utilities.java</tt> <i>(r/o)</i> - clasă internă
</li></ul>
<div style="border: 1px solid rgb(85, 85, 85); padding: 0.5em 0.5em 0.5em 2em; background-color: rgb(204, 255, 204);">
<table style="background: transparent none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous; width: 100%;">
<tbody><tr>
<td><b>Sfat</b>
</td></tr>
<tr>
<td>Cu excepţia fişierului principal (<tt>COOLParser.java</tt>), care
trebuie să se numească în acest fel, structura programului vostru se
poate modifica cum vreţi. Nimeni nu vă impune o structură anume, atâta
vreme cat programul vostru merge. Programul merge dacă:
<ul><li> Face cum trebuie analiza sintactică şi semantică.
</li><li> Comunică cum trebuie datele generatorului de cod.
</li></ul>
<p>Conţinutul arhivei este doar un punct de start împreună cu nişte
exemple de utilizare care ştim sigur că sunt corecte şi reprezintă un <i>good practice</i>. Puteţi alege să mergeţi pe aceeaşi idee, sau puteţi să o luaţi pe altă cale. Unleash your imagination&nbsp;:)
</p>
</td></tr></tbody></table>
</div>
<a name="Bonus"></a><h2> <span class="mw-headline"> Bonus </span></h2>
<p>În cadrul acestei teme puteţi obţine <b>120 puncte</b> dacă:
</p>
<ul><li> Implementaţi o serie de directive de preprocesare, pe care le
aplicaţi codului sursă original, înainte de a le trimite analizei
lexicale, sintactice şi semantice <b>şi</b> 
</li><li> Dacă trimiteţi tema cu cel puţin 3 zile înainte de deadline(mai exact, până în ziua de <b>joi, 12 noiembrie 2009, ora 22.00</b>).
</li></ul>
<a name="Formatul_directivelor_de_preprocesare"></a><h3> <span class="mw-headline"> Formatul directivelor de preprocesare </span></h3>
<p>Directivele de preprocesare în COOL încep cu simbolul "%", iar
numele lor este case insensitive. Sunt definite două tipuri de
directive:
</p>
<ul><li> <i>single-line</i>, de forma:
</li></ul>
<pre>%&lt;nume&gt; .....
</pre>
<ul><li> <i>block</i>, de forma:
</li></ul>
<pre>%&lt;nume&gt; .....

...&lt;continut COOL&gt;...

%end &lt;nume&gt;
</pre>
<p>O linie poate conţine o directivă sau poate conţine cod COOL, însă
niciodată nu pot fi amestecate pe aceeaşi linie. O directivă de
preprocesare în COOL se poate continua pe următoarea linie dacă la
sfârşitul liniei curente se adaugă caracterul "\". O linie care nu
începe cu "%" (exceptând spaţiile albe), sau care nu este o continuare
a unei directive de pe linia precedentă, nu va fi luată în considerare
de preprocesor. Directivele care apar în cadrul comentariilor COOL nu
sunt luate în considerare (preprocesorul ignoră comentariile).
</p><p><b>Variabile</b>
</p><p>Preprocesorul poate lucra cu un număr nelimitat de variabile.
Spaţiul variabilelor de preprocesor este separat de spaţiul
variabilelor din programul COOL. Numele variabilelor este
case-insensitive. Durata de viaţă a unei variabile este de la definirea
ei (printr-o directiva <tt>define</tt> sau <tt>for</tt>), până la sfârşitul fişierului sau până când devin invalide explicit (printr-o directivă <tt>undefine</tt>), sau implicit (la sfârşitul directivei <tt>for</tt>). O variabilă nedefinită se expandează la un şir gol. O variabila redefinită înlocuieşte o variabilă definită anterior.
</p><p>Tipul unei variabile este şir de caractere, cu excepţia
cazurilor în care apare în expresii cu operatori numerici, caz în care
se încearcă convertirea textului la un întreg. Dacă conversia eşuează,
este semnalată o eroare. Un text vid este convertit la valoarea 0,
într-o expresie aritmetică.
</p><p><b>Expresii</b>
</p><p>În cazul variabilelor ce pot fi convertite la un întreg, sunt
valide expresii aritmetice cu următorii operatori (în ordinea
descescătoare a priorităţii):
</p>
<ul><li> operatorul de definire (<tt>def</tt>), aplicat asupra numelui
unei variabile, întoarce 1 dacă acea variabilă este definită (este în
tabela de variabile - poate fi chiar şi o variabilă vidă!), şi 0 în caz
contrar;
</li><li> operatorul de negare (!), ce întoarce 1 dacă expresia este 0, şi 0 în caz contrar;
</li><li> înmulţire (*), împărţire (/);
</li><li> adunare (+), scădere (-);
</li><li> comparaţii (==,&nbsp;!=, &lt;, &gt;, &gt;=, &lt;=), ce întorc 1 pentru condiţie adevărată şi 0 în caz contrar;
</li><li> "şi" logic (&amp;&amp;), ce întoarce 0 dacă cel puţin una din expresii este 0, şi 1 în caz contrar;
</li><li> "sau" logic (||), ce întoarce 1 dacă cel puţi una din expresii este nenulă, şi 0 în caz contrar;
</li></ul>
<p>Expresiile pot fi parantezate pentru a altera prioritatea operatorilor.
</p><p><b>Directive single-line</b>
</p><p>1. <tt>define</tt>, defineşte o variabilă, şi are forma:
</p>
<pre>%define &lt;nume_var&gt; [&lt;text&gt;]
</pre>
<p>unde <i>nume_var</i> reprezintă numele variabilei, iar <i>text</i> este valoarea care va fi asignată variabilei. Dacă <i>text</i>
lipseşte, atunci variabila va avea conţinut vid (un şir de lungime 0).
Domeniul de definiţie al variabilei începe pe linia imediat următoare
(astfel se evită expandările recursive).
</p><p>2. <tt>undefine</tt>, înlătură definirea unei variabile, şi are forma:
</p>
<pre>%undefine &lt;nume_var&gt;
</pre>
<p>unde <i>nume_var</i> reprezintă un nume de variabilă. Dacă variabila nu există, directiva nu are nici un efect (opţional puteţi afişa un warning).
</p><p><b>Directive block</b>
</p><p>1. <tt>if</tt>, este folosită pentru a selecta un bloc de cod din mai multe opţiuni, pe baza evaluării unor expresii. Directiva are forma:
</p>
<pre>%if &lt;expr1&gt;
...
[%elif &lt;expr2&gt;]
...
...
[%else]
...
%end if
</pre>
<p>Expresiile <i>expr1</i>, <i>expr2</i>, ... sunt evaluate în ordine,
până când una dintre ele este nenulă, caz în care blocul asociat ei
este selectat. Dacă nici una nu este nenulă şi este prezent un bloc <tt>else</tt>, atunci acesta este selectat, altfel nu este selectat nici un bloc.
</p><p>2. <tt>for</tt>, este folosită pentru a multiplica un bloc de
cod, pe baza iterării unei variabile într-o mulţime de valori.
Directiva are forma:
</p>
<pre>%for &lt;nume_var&gt; in &lt;multime&gt;
...
%end for
</pre>
<p>unde <i>multime</i> poate fi de forma:
</p>
<ul><li> mulţime de valori (numerice sau nu):
</li></ul>
<pre>(&lt;expr1&gt;, &lt;expr2&gt;, ....)
</pre>
<ul><li> interval numeric, cu precizarea valorii de start şi valorii de sfârşit, şi (opţional) a unui pas de incrementare/decrementare
</li></ul>
<pre>[&lt;expr1&gt;..&lt;expr2&gt;] step &lt;expr3&gt;
</pre>
<p>Blocul de cod va apărea multiplicat de atâtea ori cât este cardinalul mulţimii de iterare, şi în fiecare bloc, variabila <i>nume_var</i> va fi definită cu valoarea corespunzătoare din mulţime, pe poziţia respectivă.
</p>
<div style="border: 1px solid rgb(85, 85, 85); padding: 0.5em 0.5em 0.5em 2em; background-color: rgb(255, 204, 170);">
<table style="background: transparent none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous; width: 100%;">
<tbody><tr>
<td><b>Atenție!</b>
</td></tr>
<tr>
<td>Directivele bloc pot fi imbricate. Modul în care sunt expandate directivele imbricate este prezentat mai jos.
</td></tr></tbody></table>
</div>
<p><b>Variabile predefinite</b>
</p><p>Variabilele predefinite pot fi folosite nemijlocit în orice
parte a codului. Orice definire de variabilă cu acelaşi nume cu a unei
variabile predefinită va fi mascată.
</p>
<ol><li> <tt>__LINE__</tt> se expandează în numărul liniei curente (din fişierul original)
</li><li> <tt>__FILE__</tt> se expandează în numele fişierului sursă
</li><li> <tt>__DATE__</tt> se expandează într-un string cu data curentă (în forma "<tt>aaaa/zz/ll hh:mm:ss</tt>")
</li></ol>
<p><b>Expandarea variabilelor</b>
</p><p>O variabilă de preprocesare sau o expresie compusă din aceste
variabile se poate expanda în orice parte a codului sursă, cu excepţia
comentariilor şi a literalilor de tip şiruri de caractere. O variabilă
se poate expanda în două moduri:
</p>
<ul><li> ca expresie separată, cu sintaxa&nbsp;% ...expr...&nbsp;%
</li><li> alipită de codul vecin, cu sintaxa&nbsp;%% ...expr...&nbsp;%%
</li></ul>
<p>În primul caz, expresia expandată este separată de restul codului
prin spaţii implicite (forţează tokeni individuali), în timp ce în al
doilea caz expandarea poate fi alipită de codul învecinat.
</p><p>De exemplu, dacă variabila VAR are valoarea 1, au loc următoarele expandări:
</p>
<pre>var%VAR% &lt;- 1;
</pre>
<p>rezultă în
</p>
<pre>var 1 &lt;- 1
</pre>
<p>în timp ce
</p>
<pre>var%%VAR%% &lt;- 1;
</pre>
<p>rezultă în
</p>
<pre>var1 &lt;- 1;
</pre>
<p><b>Comportamentul preprocesorului</b>
</p><p>Comportamentul echivalent al procesorului trebuie să respecte
următoarea paradigmă (deşi implementarea voastră poate fi mai
eficientă, ea trebuie sa fie echivalentă funcţional cu următoarea
descriere):
</p>
<ul><li> Sunt procesate toate directivele, în ordinea apariţiei. O
directivă linie procesată este înlaturată din textul final. O directivă
bloc procesată are ca rezultat blocul/-urile selectate sau generate.
Aceste blocuri pot contine la rândul lor alte directive (imbricate),
care sunt procesate recursiv.
</li><li> Rezultatul final este un cod COOL care conţine cod normal +
expresii expandabile (%&nbsp;% sau&nbsp;%%&nbsp;%%). La acest pas sunt
expandate toate aceste expresii, rezultând în final un cod COOL "pur",
ce este pasat mai departe compilatorului.
</li></ul>
<a name="Modificarea_compilatorului"></a><h3> <span class="mw-headline"> Modificarea compilatorului </span></h3>
<p>Dacă implementaţi suportul pentru directive de preprocesare, va trebui să modificaţi compilatorul în felul următor:
</p>
<ul><li> Modificaţi funcţia <tt>main()</tt> pentru a insera pasul de preprocesare.
</li><li> În urma preprocesării, generaţi un fişier <tt><i>nume_orig</i>.e</tt>,
pentru fiecare fişier în parte de la intrare, care să conţină codul
COOL rezultat în urma preprocesării (şi înainte de compilare).
</li></ul>
<a name="Instruc.C5.A3iuni_de_predare_a_temei"></a><h2> <span class="mw-headline"> Instrucţiuni de predare a temei </span></h2>
<p>Pentru a preda tema, va trebui să realizaţi o arhivă <b>.zip</b>, care să conţină următoarele în directorul ei rădăcină:
</p>
<ol><li> Codul sursă al temei, inclusiv <i>sursele</i> (fără nici un
binar!) oferite de noi. Structura arhivei voastre trebuie să fie
aceeaşi cu cea a arhivei pe care v-am pus-o la dispoziţie.
</li><li> Un fişier <tt>README</tt> în care să specificaţi numele membrilor echipei, grupele şi observaţii detaliate despre temă.
</li><li> Un fişier <tt>Makefile</tt> cu următoarele target-uri:
<ul><li> <tt>clean</tt> - şterge toate binarele şi fişierele sursă generate în urma compilării
</li><li> <tt>build</tt> - compilează tema şi generează fişierele .class corespunzătoare în directorul <tt>bin</tt> 
</li></ul>
</li></ol>
<div style="border: 1px solid rgb(85, 85, 85); padding: 0.5em 0.5em 0.5em 2em; background-color: rgb(255, 204, 170);">
<table style="background: transparent none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous; width: 100%;">
<tbody><tr>
<td><b>Atenție!</b>
</td></tr>
<tr>
<td>Nu includeţi în arhivă fişierele binare şi executabile din arhiva
originală, şi nici directorul /doc. Executabilul generatorului de cod,
script-ul bash <tt>mycool</tt>, fişierul <tt>.jar</tt> - nici unul
dintre acestea nu trebuie să fie prezent. O arhivă corectă va conţine
doar codul sursă, un Makefile care să-l compileze, şi fişierul README.
</td></tr></tbody></table>
</div>
<p>Arhiva va fi uploadată în secţiunea de Upload, de <b>un singur membru al echipei</b>. Nu are rost să uploadaţi tema de două ori, pentru fiecare persoană în parte.
</p><p><br>
</p>
<a name="Testarea_.C5.9Fi_notarea"></a><h2> <span class="mw-headline"> Testarea şi notarea </span></h2>
<p>Testarea temei de casă are loc automat, folosind o serie de teste
publice şi o altă serie de teste private. Modul în care este distribuit
punctajul pentru această temă este următorul:
</p>
<ul><li> <b>Testele publice (<i>80p</i>)</b>
<ul><li> Teste simple, pentru cazuri punctuale de elemente de limbaj elementare (<b>20p</b>)
</li><li> Teste avansate, pentru structuri de limbaj mai elaborate / dificile (<b>20p</b>)
</li><li> Teste complexe (programe complete, care rezolvă un task real) (<b>20p</b>)
</li><li> Teste eronate, menite să determine comportamentul programului pentru cod incorect (<b>20p</b>) 
</li></ul>
</li><li> <b>Testele private (<i>10p</i>)</b>
</li><li> <b>Calitatea implementării (<i>10p</i>)</b>
<ul><li> Organizarea codului sursă (<b>3p</b>)
</li><li> Comentariile din cod (<b>3p</b>)
</li><li> Explicaţiile din README - acestea trebuie să conţină o
prezentare extinsă a modului de implementare a temei, a problemelor
întâmpinate pe parcurs şi <b>modul în care munca a fost divizată între membrii echipei</b> (acolo unde este cazul). (<b>4p</b>) 
</li></ul>
</li></ul>
<p>La punctajele de mai sus se poate adăuga <b>bonusul</b>, dacă acesta este implementat complet şi trece toate testele. Bonusul valorează <b>20p</b>.
</p>
<div style="border: 1px solid rgb(85, 85, 85); padding: 0.5em 0.5em 0.5em 2em; background-color: rgb(255, 204, 170);">
<table style="background: transparent none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous; width: 100%;">
<tbody><tr>
<td><b>Atenție!</b>
</td></tr>
<tr>
<td>Pentru ca <b>bonusul</b> să poată fi testat automat, acesta trebuie să fie compilat de către Makefile-ul vostru cu numele <tt>COOLParserPreproc.class</tt>. Evaluatorul va folosi <tt>COOLParser.class</tt> pentru testele normale, şi va verifica dacă există <tt>COOLParserPreproc.class</tt> şi îl va folosi pe acesta pentru testele de bonus.
</td></tr></tbody></table>
</div>
<a name="Download"></a><h2> <span class="mw-headline"> Download </span></h2>
<ul><li> <b><a href="http://cs.pub.ro/%7Ecpl/wiki/images/f/fc/Test_tema2_1_11_2009.zip" class="external text" title="http://cs.pub.ro/~cpl/wiki/images/f/fc/Test_tema2_1_11_2009.zip" rel="nofollow">Arhiva</a></b> de test folosită pentru evaluarea automată a temelor de casă.
</li></ul>
<div style="border: 1px solid rgb(85, 85, 85); padding: 0.5em 0.5em 0.5em 2em; background-color: rgb(255, 204, 170);">
<table style="background: transparent none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous; width: 100%;">
<tbody><tr>
<td><b>Atenție!</b>
</td></tr>
<tr>
<td>Am pus testele publice finale pentru tema2. Testele private vor
consta numai din teste ce verifica functionalitati ale limbajului COOL,
cu alte cuvinte nu voi avea teste private si pentru bonus.
</td></tr></tbody></table>
</div>
<ul><li> <b><a href="http://cs.pub.ro/%7Ecpl/wiki/images/1/1a/Bonus_3_11_2009.zip" class="external text" title="http://cs.pub.ro/~cpl/wiki/images/1/1a/Bonus_3_11_2009.zip" rel="nofollow">Teste pentru bonus</a></b> 
</li></ul>
<div style="border: 1px solid rgb(85, 85, 85); padding: 0.5em 0.5em 0.5em 2em; background-color: rgb(255, 204, 170);">
<table style="background: transparent none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous; width: 100%;">
<tbody><tr>
<td><b>Atenție!</b>
</td></tr>
<tr>
<td>Am pus si testele publice pentru bonus.
</td></tr></tbody></table>
</div>
<ul><li> <b><a href="http://cs.pub.ro/%7Ecpl/arhive/cool-manual.pdf" class="external text" title="http://cs.pub.ro/~cpl/arhive/cool-manual.pdf" rel="nofollow">Manualul</a></b> oficial al limbajului COOL.
</li><li> <b><a href="http://cs.pub.ro/%7Ecpl/static/tema2/t2cpl.tar.gz" class="external text" title="http://cs.pub.ro/~cpl/static/tema2/t2cpl.tar.gz" rel="nofollow">Arhiva</a></b> de pornire pentru rezolvarea temei (găsiţi <a href="http://cs.pub.ro/%7Ecpl/static/tema2/treeapi/" class="external text" title="http://cs.pub.ro/~cpl/static/tema2/treeapi/" rel="nofollow">aici</a> separat documentaţia JavaDoc pentru sursele din arhivă)
</li></ul>

<!-- 
NewPP limit report
Preprocessor node count: 238/1000000
Post-expand include size: 6920/2097152 bytes
Template argument size: 4394/2097152 bytes
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key cplwiki-wiki_:pcache:idhash:30-0!1!0!!en!2!edit=0 and timestamp 20091103215243 -->
	    </td></tr>
	    </tbody></table>
	</td>
	<td width="1%">
	    &nbsp;
	</td>
	<td valign="top" width="16%">
	    <br>
	    
	<br>
	<table width="100%" border="0" cellpadding="5" cellspacing="4">
    	<tbody><tr><td align="center" bgcolor="#cc99ff"> 
	
        <a href="http://cs.pub.ro/%7Ecpl/index.php" class="linknavy">Teme</a>
	
	</td></tr>
        <tr><td align="center" bgcolor="slateblue"> 
	<br><a href="http://cs.pub.ro/%7Ecpl/index.php?section=Teme&amp;file=Notare" class="linkwhite">Notare </a><br><br><a href="http://cs.pub.ro/%7Ecpl/index.php?section=Teme&amp;file=Reguli" class="linkwhite">Reguli </a><br><br><a href="http://cs.pub.ro/%7Ecpl/index.php?section=Teme&amp;file=Tema%201" class="linkwhite">Tema 1 </a><br><br><a href="http://cs.pub.ro/%7Ecpl/index.php?section=Teme&amp;file=Tema%202" class="linkwhite">Tema 2 <br>(03 Nov 23:52)</a><br><br><a href="http://cs.pub.ro/%7Ecpl/index.php?section=Teme&amp;file=Tema%203" class="linkwhite">Tema 3 </a><br><br><a href="http://cs.pub.ro/%7Ecpl/index.php?section=Teme&amp;file=Tema%204" class="linkwhite">Tema 4 </a><br><br><a href="http://cs.pub.ro/%7Ecpl/index.php?section=Teme&amp;file=Tema%205" class="linkwhite">Tema 5 </a><br>
	<br></td></tr>
	<tr><td bgcolor="white">&nbsp;<br><br></td></tr>
	</tbody></table>
		</td>
    </tr>
    <tr>
	<td></td>
    </tr>

</tbody></table>
<br><br></td></tr></tbody></table>
</body></html>